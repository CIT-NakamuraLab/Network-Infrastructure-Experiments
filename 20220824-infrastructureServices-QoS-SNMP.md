# QoS

## 概要
- 実験日: 2022/07/24
- CCNA第 11章 その他のインフラストラクチャサービスと運用

---
## 1 QoSのまとめ

* QoSとは､パケットに優先番号を付加することで遅延などのサービス品質を優先的に転送するプロトコル

* QoSの種類
  * IntServ
    * IntServとは､帯域を確保することで品質を保つことができる技術の1つ
    * IntServのデメリット:各ルータが帯域を確保するという情報を保持し続けなければならない
  * DiffServ
    * DiffServとは､パケットに設定している優先度に従い優先的に転送する技術の1つ
    * DiffServのデメリット:IntServと比較して､帯域を確保しないため通信速度を保証することができない
 
<br><br>

* DiffServの種類
  * CoS
    * イーサネットフレームの優先度を表すもの
    * PCPタイプを利用する
    * CoSは､IEEE802.1Qタグの3ビットのフレームで表すことができるのは7種類のみ
      !["CoSパケットフレームの中身"](./images/20220824-infrastructureServicesImg/20220824-infrastructureServices_4.jpeg)
  * DSCP
    * IPパケットの優先度を表すもの
    * IPヘッダ内のサービスタイプを利用する
    * 6ビットを使用して､前半3ビットは優先度を後半3ビットは破棄レベルを表す｡

* 信頼境界
  * 信頼する区間と信頼しない区間を区別する
  * 信頼境界はなぜ必要なのか
    * 動画再生が遅い場合に､パケットキャプチャなどでパケットのヘッダーを偽造されることで､CoSの値が変更されるため優先度が変化する｡優先度が変化しているパケットによってルータやスイッチに対して負荷がかかるため必要
* ポリシング
  * 最低限保証している伝送速度を超過するとトラフィックを破棄することや優先度を変更することで回線の占有を防ぐ
* シェーピング
  * 伝送速度の設定値を超過するとルータやスイッチのバッファに保持し遅れて送信する
* PQ
  * 優先度が異なるパケットを4つに分けて領域を並べる
  * 優先度は､｢High｣､｢Medium｣､｢Normal｣､｢Low｣に分けている
  * 優先度の高いものから送信されるため､低い優先度は､高いものが送信し終えるまで送信されることはない
* WFQ
  * 優先度の領域ごとに重みを付けて送信するパケットの比率を変化するプロトコル
* CB-WFQ
  * 管理者が定義した領域を割り当て､最低帯域幅の指定によって送信するパケットの比率を変化するプロトコル
* 輻輳の管理
  * RED
    * 領域がいっぱいになる前に､パケットをランダムに破棄するプロトコル
  * WRED
    * 領域がいっぱいになる前に､パケットの優先順位を考慮して破棄するプロトコル

---
## 2 参考文献･引用
[WatchGuard Help Center､｢VLAN インターフェイスの 802.1p マーキングについて｣､2022/09/09アクセス](https://www.watchguard.com/help/docs/help-center/ja-JP/Content/en-US/Fireware/networksetup/images/diagram_vlan_layer2_marking.jpg)